---
layout: 'post'
title: '工作筆記: dz-05 12月, 1月, 2月 壓縮在壓縮~'
permalink: 'work-note/dz-o5'
tags: 工作筆記 javascript db gitlab
---

# Javascript
---

## [jexcel CE](https://bossanova.uk/jspreadsheet/v3/examples/react){:target="_back"}

~~~javascript
class Jexcel extends React.Component {
    constructor(props) {
        super(props);
        this.options = props.options;
    }

    componentDidMount = function() {
        this.el = jexcel(ReactDOM.findDOMNode(this).children[0], this.options);
    }

    addRow = function() {
        this.el.insertRow();
    }

    render() {
        return (
            <div>
                <div></div><br/><br/>
                <input type='button' value='Add new row' onClick={() => this.addRow()}></input>
            </div>
        );
    }
}

var options = {
    data:[[]],
    minDimensions:[10,10],
};

ReactDOM.render(<Jexcel options={options} />, document.getElementById('spreadsheet'))
~~~

## [ESLint Warning “Function declared in a loop contains unsafe references to variable(s)…no-loop-func”](https://stackoverflow.com/questions/58816244/debugging-eslint-warning-function-declared-in-a-loop-contains-unsafe-reference){:target="_back"}

> After I did some reserch, I found in this post, [JSHint error : Functions declared within loops referencing an outer scoped variable may lead to confusing semantics,](https://stackoverflow.com/questions/46538640/jshint-error-functions-declared-within-loops-referencing-an-outer-scoped-varia) mentioned that JSHint doesn't like how the anonymous function in there is being re-created over and over.
>
> I changed forEach arrow function to for (let index i = 0; index < someInputs.length; index++), and the warning is gone.
>
>Perhaps in your case, change setTimeout to traditional non-arrow function can remove the warning.

## [moment() get timestamp](https://stackoverflow.com/questions/25734743/how-to-return-the-current-timestamp-with-moment-js){:target="_back"}

~~~javascript
moment().toDate().getTime()
~~~

- parse utc format 

   - `moment().utc().format()`

## regex

- `/.+/g`
   - So the difference between /.+/g and /.+/ is that the g version will find every occurrence instead of just the first.


<br/>
<br/>
<br/>

# DB
---

## Add constraint

~~~sql
alter table public.TABLE ADD CONSTRAINT TABLE_UN UNIQUE ("name", "id");
~~~

## Find Duplicated value in one column

~~~sql
select p.number,
       count(p.number)
from product p
group by p.number
having count(p.number) > 1;
~~~

~~~sql
select p.number,
       count(p.number),
       p.id ,
       count(p.id )
from product p
group by 
    p.number,
    p.id 
having 
    count(p.number) > 1 and 
    count(p.id ) > 1;
~~~


<br/>
<br/>
<br/>

# CI/CD
---


## Gitlab Auto CI/CD

- settings 
   - ci/cd 
      - Variables
         - Build and deployment
             - [https://docs.gitlab.com/ee/topics/autodevops/customize.html]
         - expand: add variable